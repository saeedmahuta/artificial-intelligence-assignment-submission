<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>12 Coin Problem Visualizer</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; text-align: center; padding: 20px; }
        h1 { color: #333; }
        
        /* The Stage */
        #container {
            position: relative;
            width: 800px;
            height: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* The Coins */
        .coin {
            width: 40px;
            height: 40px;
            background: gold;
            border: 3px solid #d4af37;
            border-radius: 50%;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #b8860b;
            font-size: 18px;
            transition: all 1s ease-in-out;
            z-index: 10;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        /* Highlights for the answer */
        .coin.fake { border-color: red; color: red; }
        .coin.real { opacity: 0.5; }

        /* The Balance Scale */
        #scale-base {
            position: absolute;
            bottom: 50px;
            left: 390px;
            width: 0; 
            height: 0; 
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 150px solid #555;
        }
        
        #scale-beam {
            position: absolute;
            top: 200px;
            left: 200px;
            width: 400px;
            height: 8px;
            background: #333;
            transition: transform 1s ease-in-out;
            transform-origin: center;
        }

        .pan {
            position: absolute;
            top: 0px; /* Relative to beam */
            width: 120px;
            height: 80px;
            border-left: 2px solid #aaa;
            border-right: 2px solid #aaa;
            border-bottom: 4px solid #aaa;
            border-radius: 0 0 20px 20px;
            background: rgba(200,200,200,0.2);
        }
        
        /* Strings holding the pans */
        .string {
            position: absolute;
            top: 0;
            width: 2px;
            height: 100px; /* Length of string */
            background: #aaa;
        }

        #pan-left-visual { 
            position: absolute; 
            top: 8px; left: 0; 
            transform: translate(-50%, 0); 
        }
        #pan-right-visual { 
            position: absolute; 
            top: 8px; right: 0; 
            transform: translate(50%, 0); 
        }

        /* The pivot point */
        #pivot {
            position: absolute;
            left: 50%;
            top: -5px;
            width: 20px;
            height: 20px;
            background: #555;
            border-radius: 50%;
            transform: translate(-50%, 0);
        }

        /* Controls */
        #controls { margin-top: 20px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; }
        button:disabled { background: #ccc; }
        select { padding: 10px; font-size: 16px; }

        #log {
            margin-top: 20px;
            font-family: monospace;
            background: #222;
            color: #0f0;
            padding: 10px;
            width: 800px;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
            border-radius: 5px;
            min-height: 100px;
        }
    </style>
</head>
<body>

    <h1>12 Coin Problem: Adaptive Algorithm</h1>

    <div id="container">
        <div id="scale-base"></div>
        <div id="scale-beam">
            <div id="pivot"></div>
            <div id="pan-left-visual" class="pan"></div>
            <div id="pan-right-visual" class="pan"></div>
        </div>
    </div>

    <div id="controls">
        <label>Fake Coin:</label>
        <select id="targetCoin">
            </select>
        <select id="targetWeight">
            <option value="heavy">Is Heavy</option>
            <option value="light">Is Light</option>
        </select>
        <button onclick="startSimulation()" id="startBtn">Start Animation</button>
    </div>

    <div id="log">Waiting to start...</div>

    <script>
        // Setup Coins
        const container = document.getElementById('container');
        const coins = [];
        const beam = document.getElementById('scale-beam');
        const logBox = document.getElementById('log');
        
        // Initial Coin Positions (Top Shelf)
        const startX = 140;
        const gap = 45;
        
        function initCoins() {
            // Clear existing
            document.querySelectorAll('.coin').forEach(c => c.remove());
            coins.length = 0;

            for (let i = 1; i <= 12; i++) {
                let c = document.createElement('div');
                c.className = 'coin';
                c.innerText = i;
                c.id = 'coin-' + i;
                // Position them in a row at the top
                c.style.left = (startX + (i-1)*gap) + 'px';
                c.style.top = '30px';
                container.appendChild(c);
                coins[i] = c; // 1-based index for convenience
            }
        }

        // Fill dropdown
        const sel = document.getElementById('targetCoin');
        for(let i=1; i<=12; i++) {
            let opt = document.createElement('option');
            opt.value = i;
            opt.innerText = "Coin " + i;
            if(i===7) opt.selected = true;
            sel.appendChild(opt);
        }

        initCoins();

        // Helper: Pause for animation
        const sleep = (ms) => new Promise(r => setTimeout(r, ms));

        function log(msg) {
            logBox.innerText += "\n> " + msg;
            logBox.scrollTop = logBox.scrollHeight;
        }

        // --- THE ANIMATION LOGIC ---

        async function resetBoard() {
            beam.style.transform = "rotate(0deg)";
            for (let i = 1; i <= 12; i++) {
                coins[i].style.left = (startX + (i-1)*gap) + 'px';
                coins[i].style.top = '30px';
                coins[i].style.transform = "scale(1)";
                coins[i].classList.remove('fake', 'real');
                coins[i].style.opacity = "1";
            }
            logBox.innerText = "Simulation initialized.";
            await sleep(1000);
        }

        async function weigh(leftIds, rightIds, target, isHeavy) {
            log(`Weighing: [${leftIds}] vs [${rightIds}]`);
            
            // 1. Reset Scale Tilt
            beam.style.transform = "rotate(0deg)";
            await sleep(500);

            // 2. Move coins to pans
            // Left Pan coords (relative to container) roughly:
            // Beam center is 400. Left pan center is 200. Right pan center is 600.
            // But coins move with the pan visually? simplified: we move them to fixed xy
            
            // NOTE: In a real physics engine, we'd parent them to the beam. 
            // Here we just move them to "Left Pan Area" and "Right Pan Area"
            
            leftIds.forEach((id, idx) => {
                coins[id].style.left = (200 - 40 + (idx%2)*45) + 'px'; // Cluster them
                coins[id].style.top = (250 + Math.floor(idx/2)*40) + 'px';
            });
            
            rightIds.forEach((id, idx) => {
                coins[id].style.left = (600 - 40 + (idx%2)*45) + 'px';
                coins[id].style.top = (250 + Math.floor(idx/2)*40) + 'px';
            });

            // Move others back to shelf (if they were used previously)
            const used = [...leftIds, ...rightIds];
            for(let i=1; i<=12; i++) {
                if(!used.includes(i)) {
                    coins[i].style.left = (startX + (i-1)*gap) + 'px';
                    coins[i].style.top = '30px';
                }
            }

            await sleep(1500); // Wait for move

            // 3. Calculate Result
            let leftW = 0, rightW = 0;
            leftIds.forEach(id => {
                if(id == target) leftW += (isHeavy ? 1 : -1);
            });
            rightIds.forEach(id => {
                if(id == target) rightW += (isHeavy ? 1 : -1);
            });

            // 4. Animate Tilt
            if (leftW > rightW) {
                beam.style.transform = "rotate(-15deg)"; // Left goes down (Counter Clockwise)
                // Adjust coin heights roughly to match tilt
                leftIds.forEach(id => coins[id].style.top = (parseInt(coins[id].style.top) + 20) + 'px');
                rightIds.forEach(id => coins[id].style.top = (parseInt(coins[id].style.top) - 20) + 'px');
                log("Result: Left Side is HEAVIER");
                await sleep(2000);
                return 1;
            } else if (rightW > leftW) {
                beam.style.transform = "rotate(15deg)"; // Right goes down
                leftIds.forEach(id => coins[id].style.top = (parseInt(coins[id].style.top) - 20) + 'px');
                rightIds.forEach(id => coins[id].style.top = (parseInt(coins[id].style.top) + 20) + 'px');
                log("Result: Right Side is HEAVIER");
                await sleep(2000);
                return -1;
            } else {
                beam.style.transform = "rotate(0deg)";
                log("Result: Balanced (Equal)");
                await sleep(2000);
                return 0;
            }
        }

        async function startSimulation() {
            document.getElementById('startBtn').disabled = true;
            await resetBoard();

            const target = parseInt(document.getElementById('targetCoin').value);
            const isHeavy = document.getElementById('targetWeight').value === 'heavy';

            log(`Starting... (Hidden: Coin ${target} is ${isHeavy ? 'Heavy' : 'Light'})`);

            // --- ALGORITHM 1 LOGIC (ADAPTIVE) ---
            
            // Weigh 1: 1,2,3,4 vs 5,6,7,8
            let w1 = await weigh([1,2,3,4], [5,6,7,8], target, isHeavy);

            if (w1 === 0) {
                // Fake is in 9,10,11,12. 
                // Weigh 2: 1,2,3 (Real) vs 9,10,11
                let w2 = await weigh([1,2,3], [9,10,11], target, isHeavy);
                
                if (w2 === 0) {
                    // Fake is 12. Weigh 3: 1 (Real) vs 12
                    let w3 = await weigh([1], [12], target, isHeavy);
                    highlightResult(12, w3 < 0 ? "Heavy" : "Light"); // If 1 < 12, 12 is Heavy
                } else {
                    // Fake is in 9,10,11.
                    // If w2 > 0 (Left/Real Heavier), then Target (Right) is LIGHT.
                    // If w2 < 0 (Right/Target Heavier), then Target is HEAVY.
                    let suspectIsHeavy = (w2 < 0);
                    
                    // Weigh 3: 9 vs 10
                    let w3 = await weigh([9], [10], target, isHeavy);
                    if (w3 === 0) highlightResult(11, suspectIsHeavy ? "Heavy" : "Light");
                    else if (w3 > 0) highlightResult(9, suspectIsHeavy ? "Heavy" : "Light"); // Left (9) heavier
                    else highlightResult(10, suspectIsHeavy ? "Heavy" : "Light");
                }
            } else if (w1 > 0) { 
                // Left (1,2,3,4) is Heavier.
                // Weigh 2: 1,2,5 vs 3,6,12(Real)
                let w2 = await weigh([1,2,5], [3,6,12], target, isHeavy);
                
                if (w2 === 0) {
                    // Fake is 4(H), 7(L), or 8(L). Weigh 3: 7 vs 8
                    let w3 = await weigh([7], [8], target, isHeavy);
                    if(w3 === 0) highlightResult(4, "Heavy");
                    else if(w3 > 0) highlightResult(8, "Light"); // 7 Heavier means 8 is Light? No, 7/8 are potentially Light. If 7>8, 8 is Light.
                    else highlightResult(7, "Light");
                } else if (w2 > 0) {
                    // Sign stayed same. 1(H), 2(H), or 6(L). Weigh 3: 1 vs 2
                    let w3 = await weigh([1], [2], target, isHeavy);
                    if(w3 === 0) highlightResult(6, "Light");
                    else if(w3 > 0) highlightResult(1, "Heavy");
                    else highlightResult(2, "Heavy");
                } else {
                    // Sign flipped. 3(H) or 5(L). Weigh 3: 3 vs 12(Real)
                    let w3 = await weigh([3], [12], target, isHeavy);
                    if(w3 > 0) highlightResult(3, "Heavy");
                    else highlightResult(5, "Light");
                }
            } else { 
                // Right (5,6,7,8) is Heavier. (w1 < 0)
                // Weigh 2: 1,2,5 vs 3,6,12
                let w2 = await weigh([1,2,5], [3,6,12], target, isHeavy);
                
                if (w2 === 0) {
                    // Fake 4(L), 7(H), 8(H). Weigh 7 vs 8
                    let w3 = await weigh([7], [8], target, isHeavy);
                    if(w3 === 0) highlightResult(4, "Light");
                    else if(w3 > 0) highlightResult(7, "Heavy");
                    else highlightResult(8, "Heavy");
                } else if (w2 < 0) {
                    // Sign stayed same (Left < Right). 1(L), 2(L), 6(H). Weigh 1 vs 2
                    let w3 = await weigh([1], [2], target, isHeavy);
                    if(w3 === 0) highlightResult(6, "Heavy");
                    else if(w3 < 0) highlightResult(1, "Light");
                    else highlightResult(2, "Light");
                } else {
                    // Sign flipped. 3(L) or 5(H). Weigh 3 vs 12
                    let w3 = await weigh([3], [12], target, isHeavy);
                    if(w3 < 0) highlightResult(3, "Light");
                    else highlightResult(5, "Heavy");
                }
            }
            document.getElementById('startBtn').disabled = false;
        }

        function highlightResult(coinId, text) {
            log(`SOLVED: Coin ${coinId} is ${text}!`);
            coins[coinId].classList.add('fake');
            coins[coinId].innerText += "\n" + text.charAt(0); // Add H or L label
            coins[coinId].style.transform = "scale(1.5)";
            coins[coinId].style.zIndex = 100;
        }
    </script>
</body>
</html>